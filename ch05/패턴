using System;
using System.Runtime.InteropServices;

namespace ConsoleApp1
{
    enum Color
    {
        Red,
        Green,
        Blue
    }
    class Point
    {
        public int X { get; set; }
        public int Y { get; set; }
    }
    class Program
    {
        static void Main(string[] args)
        {
            //선언 패턴 
            object obj = "Hello, World!";
            if (obj is string str)  // obj가 string 타입이면 str로 변환
            {
                Console.WriteLine($"이거 문자열임{str}");
            }
            //형식 패턴
            object foo = 23;
            if (foo is int) // foo가 int 타입인지 확인
            {
                Console.WriteLine(foo);
            }
            //상수 패턴
            obj = null;
            if (obj is null) // obj가 null인지 확인
            {
                Console.WriteLine("obj는 null입니다.");
            }
            var color = (string COlor) => COlor switch //color 변수를 string으로 받아서 switch문으로 처리
            {
                "Red" => Color.Red,
                "Green" => Color.Green,
                "Blue" => Color.Blue,
                _ => throw new ArgumentException("Unknown color")
            };
            Color result = color("Green"); //color 함수 호출 "Green" 전달
            //이 때 switch문 실행 그 결과를 result에 저장
            Console.WriteLine(result);
            //프로퍼티 패턴
            //입력된 식이 int,double 같은 기본 형이 아닌 복합 형식일 때 유용함 
            var point = new Point { X = 10, Y = 20 };
            if (point is { X: 10, Y: 20 }) //point 객체의 X와 Y 프로퍼티가 각각 10과 20인지 확인
            {
                Console.WriteLine("Point is at (10, 20)"); //조건이 참이면 출력 
            }
            //관계 패턴
            int score = 85;
            static  char IsGrade(int grade) => grade switch
            {
                >= 90 => 'A',
                >= 80 => 'B',
                >= 70 => 'C',
                >= 60 => 'D',
                _ => 'F'
            };
            Console.WriteLine(IsGrade(score)); //score 변수를 IsGrade 함수에 전달하고 결과 출력
            //논리 패턴 
            // 패턴과 패턴을 결합하여 복잡한 조건을 표현할 수 있음
            object value = 42;
            if (value is int  and >= 0 and <= 100) //value가 int 타입이고 0에서 100 사이인지 확인
            {
                Console.WriteLine($"Value is a valid score: {value}"); //조건이 참이면 출력
            }
            //위치 패턴
            Tuple<string, int> person = new Tuple<string, int>("Alice", 30);
            if ( person is ("Alice", < 40))
            {
                Console.WriteLine("Alice is under 40 years old.");
            }
            //식의 결과를 분해하고 값들이 복수의 패턴과 일치하는지 확인 
            //다만 패턴의 개수와 순서가 분해되는 값과 일치해야 함
            
            //var 패턴
            var Ispassed = (int[] scores) => scores.Sum() / scores.Length is var average and >= 60
                ? "Passed"
                : "Failed";
            //scores 배열의 평균을 계산하고 그 결과를 average 변수에 저장
            //이처럼 임시 변수에 결과를 저장하여 이후 조건에서 사용할 수 있음

            //목록 패턴
            var match = (int[] arr) => arr is [int, > 10, _]; //배열이 세 개의 요소를 가지고 두 번째 요소가 10보다 큰지 확인 그 이후는 무시
            Console.WriteLine(match(new int[] { 1, 15, 3 })); //true
            Console.WriteLine(match(new int[] {1, 5, 3 })); //false
            var match2 = (int[] arr) => arr is [int, >10,..]; //배열이 두 개 이상의 요소를 가지고 두 번째 요소가 10보다 큰지 확인 그 이후는 무시
            Console.WriteLine(match2(new int[] { 1, 15, 3, 4, 5 })); //true
            Console.WriteLine(match2(new int[] { 1, 5, 3 })); //false
        }
    }
    class Fibonacci
    {
        public static long GetNumber(long index)
        {
            long resultValue(long index) => index switch
            {
                0 => 0,
                1 => 1,
                _ => GetNumber(index - 1) + GetNumber(index - 2)
            };
            long result = resultValue(index);
            return result;
        }
    }
}
